{"version":3,"sources":["App.tsx","index.tsx"],"names":["HOST","App","fileInput","useRef","useState","url","setUrl","uploadId","fileUploaderClient","FileUploaderClient","chunkSize","requestOptions","retryTimes","initFilePartUploadFunc","a","fileName","current","files","name","axios","post","data","console","log","uploadPartFileFunc","chunk","index","formData","FormData","append","toString","headers","finishFilePartUploadFunc","md5","path","className","type","ref","value","onClick","uploadFile","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"8RAKMA,EAAO,0BA+DEC,MA7Df,WACE,IAAMC,EAAYC,iBAAO,MACzB,EAAsBC,mBAAiB,IAAvC,mBAAOC,EAAP,KAAYC,EAAZ,KACIC,EAAW,GAETC,EAAqB,IAAIC,IAAmB,CAChDC,UAAW,QACXC,eAAgB,CACdC,WAAY,EACZC,uBAAuB,WAAD,4BAAE,gCAAAC,EAAA,6DAChBC,EAAYb,EAAUc,QAAgBC,MAAM,GAAGC,KAD/B,SAECC,IAAMC,KAAN,UAAcpB,EAAd,kBAAoC,CACzDkB,KAAMH,IAHc,gBAEdM,EAFc,EAEdA,KAGRd,EAAWc,EAAKd,SAChBe,QAAQC,IAAI,8CACZjB,EAAO,IAPe,2CAAF,kDAAC,GASvBkB,mBAAmB,WAAD,4BAAE,WAAOC,EAAaC,GAApB,eAAAZ,EAAA,6DACZa,EAAW,IAAIC,UACZC,OAAO,WAAYtB,GAC5BoB,EAASE,OAAO,YAAaH,EAAMI,YACnCH,EAASE,OAAO,WAAYJ,GAJV,SAMZN,IAAMC,KAAN,UAAcpB,EAAd,kBAAoC2B,EAAU,CAClDI,QAAS,CAAE,eAAgB,yBAPX,OASlBT,QAAQC,IAAR,kCAAmBG,EAAnB,iBATkB,2CAAF,qDAAC,GAWnBM,yBAAyB,WAAD,4BAAE,WAAOC,GAAP,mBAAAnB,EAAA,6DAClBC,EAAYb,EAAUc,QAAgBC,MAAM,GAAGC,KAD7B,SAEDC,IAAMC,KAAN,UAAcpB,EAAd,oBAAsC,CAC3DkB,KAAMH,EACNR,WACA0B,QALsB,gBAEhBZ,EAFgB,EAEhBA,KAKRC,QAAQC,IAAR,4EAA0BvB,GAA1B,OAAiCqB,EAAKa,OACtC5B,EAAO,GAAD,OAAIN,GAAJ,OAAWqB,EAAKa,OARE,2CAAF,mDAAC,MAmB7B,OACE,sBAAKC,UAAU,MAAf,UACE,yDACA,wIACA,sBAAKA,UAAU,MAAf,UACE,uBAAOC,KAAK,OAAOlB,KAAK,OAAOmB,IAAKnC,IACpC,uBAAOkC,KAAK,SAASE,MAAM,2BAAOC,QAZzB,WACTrC,EAAUc,SACZR,EAAmBgC,WAAYtC,EAAUc,QAAgBC,MAAM,UAY9DZ,GAAO,qEAAaA,SC3D3BoC,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEFC,SAASC,eAAe,W","file":"static/js/main.757cec5a.chunk.js","sourcesContent":["import { useRef, useState } from 'react'\nimport './App.css'\nimport { FileUploaderClient } from 'file-uploader-client'\nimport axios from 'axios'\n\nconst HOST = 'http://localhost:10001/'\n\nfunction App() {\n  const fileInput = useRef(null)\n  const [url, setUrl] = useState<string>('')\n  let uploadId = ''\n\n  const fileUploaderClient = new FileUploaderClient({\n    chunkSize: 2 * 1024 * 1024, // 2MB\n    requestOptions: {\n      retryTimes: 2,\n      initFilePartUploadFunc: async () => {\n        const fileName = (fileInput.current as any).files[0].name\n        const { data } = await axios.post(`${HOST}api/initUpload`, {\n          name: fileName,\n        })\n        uploadId = data.uploadId\n        console.log('初始化上传完成')\n        setUrl('')\n      },\n      uploadPartFileFunc: async (chunk: Blob, index: number) => {\n        const formData = new FormData()\n        formData.append('uploadId', uploadId)\n        formData.append('partIndex', index.toString())\n        formData.append('partFile', chunk)\n\n        await axios.post(`${HOST}api/uploadPart`, formData, {\n          headers: { 'Content-Type': 'multipart/form-data' },\n        })\n        console.log(`上传分片${index}完成`)\n      },\n      finishFilePartUploadFunc: async (md5: string) => {\n        const fileName = (fileInput.current as any).files[0].name\n        const { data } = await axios.post(`${HOST}api/finishUpload`, {\n          name: fileName,\n          uploadId,\n          md5,\n        })\n        console.log(`上传完成，存储地址为：${HOST}${data.path}`)\n        setUrl(`${HOST}${data.path}`)\n      },\n    },\n  })\n\n  const upload = () => {\n    if (fileInput.current) {\n      fileUploaderClient.uploadFile((fileInput.current as any).files[0])\n    }\n  }\n\n  return (\n    <div className=\"App\">\n      <h1>easy-file-uploader-demo</h1>\n      <h3>选择文件后点击“上传文件”按钮即可</h3>\n      <div className=\"App\">\n        <input type=\"file\" name=\"file\" ref={fileInput} />\n        <input type=\"button\" value=\"上传文件\" onClick={upload} />\n      </div>\n      {url && <h3>{`文件地址：${url}`}</h3>}\n    </div>\n  )\n}\n\nexport default App\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n)\n"],"sourceRoot":""}